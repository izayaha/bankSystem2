<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="layui/css/layui.css">
</head>
<body>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
    <legend>上传头像</legend>
</fieldset>
<form method="post" enctype="multipart/form-data">
<div class="layui-upload">
    <button type="button" class="layui-btn layui-btn-normal" id="test8" name="file" >选择文件</button>
    <button type="button" class="layui-btn" id="test9">开始上传</button>
</div>
</form>
<script src="layui/layui.js"></script>
<script type="text/javascript" src="js/jquery.form.min.js"></script>
<script type="text/javascript" src="js/jquery-1.12.2.min.js"></script>
<script>
    layui.use('upload', function(){
        var $ = layui.jquery
            ,upload = layui.upload;

        //选完文件后不自动上传
        upload.render({
            elem: '#test8'
            ,url: 'upload.do' //改成您自己的上传接口
            ,auto: false
           // ,multiple: true
            ,bindAction: '#test9'
            ,done: function(res){
                layer.msg('上传成功');
                console.log(res);
                window.parent.updateHeader();
            }
        });

    });

    // $("form").submit(function () {
    //     //$.ajax 不能异步上传
    //     //$.ajaxSubmit  才能异步上传
    //     $("form").ajaxSubmit({
    //         type:"post",
    //         url:"upload.do",
    //         data:$("form").serialize(),
    //         dataType:"json",
    //         success:function (data) {
    //             //   alert(data.info)
    //             window.parent.updateHeader();
    //         }
    //     })
    //     return false;
    // })

</script>
</body>
</html>
